{% extends "base.html" %}

{% block title %}Rate Limiting - QA Pet Project{% endblock %}

{% block extra_css %}
<style>
  .container {
    max-width: 1000px;
    margin: 50px auto;
    padding: 30px;
    border-radius: 10px;
    background-color: var(--bg-primary);
    box-shadow: var(--shadow);
  }

  .header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border-light);
  }

  .header h1 {
    color: var(--text-primary);
    margin-bottom: 10px;
  }

  .rate-limits {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .limit-card {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    background-color: var(--bg-primary);
  }

  .limit-card h3 {
    color: var(--text-primary);
    margin-bottom: 15px;
    border-bottom: 1px solid var(--border-light);
    padding-bottom: 10px;
  }

  .limit-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--border-light);
  }

  .limit-item:last-child {
    border-bottom: none;
  }

  .endpoint {
    font-weight: bold;
    color: var(--text-primary);
  }

  .limit {
    background-color: var(--info-bg);
    color: var(--info-text);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
  }

  .stats {
    background-color: var(--bg-tertiary);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .stats h3 {
    color: var(--text-primary);
    margin-bottom: 15px;
  }

  .stat-item {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid var(--border-light);
  }

  .stat-item:last-child {
    border-bottom: none;
  }

  .back-link {
    display: inline-block;
    margin-bottom: 20px;
    color: var(--text-primary);
    text-decoration: none;
    padding: 8px 16px;
    background-color: var(--bg-tertiary);
    border-radius: 4px;
    transition: background-color 0.3s ease;
  }

  .back-link:hover {
    background-color: var(--bg-secondary);
  }

  .info-box {
    background-color: var(--info-bg);
    color: var(--info-text);
    padding: 15px;
    border-radius: 8px;
    border: 1px solid var(--info-border);
    margin-bottom: 20px;
  }

  .warning-box {
    background-color: var(--warning-bg);
    color: var(--warning-text);
    padding: 15px;
    border-radius: 8px;
    border: 1px solid var(--warning-border);
    margin-bottom: 20px;
  }
</style>
{% endblock %}

{% block content %}
<div class="container">
  <a href="{{ url_for('main.home') }}" class="back-link">‚Üê –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>

  <div class="header">
    <h1>üö¶ Rate Limiting - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤</h1>
    <p>–°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π –∏ DDoS –∞—Ç–∞–∫</p>
  </div>

  <div class="info-box">
    <h4>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h4>
    <p>Rate limiting –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∏ –∑–∞—â–∏—â–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏. –õ–∏–º–∏—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ IP –∞–¥—Ä–µ—Å–∞ –∏ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.</p>
  </div>

  <div class="warning-box">
    <h4>‚ö†Ô∏è –í–∞–∂–Ω–æ</h4>
    <p>–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è HTTP 429 (Too Many Requests). –ö–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–¥–æ–∂–¥–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π.</p>
  </div>

  <div class="stats">
    <h3>üìä –¢–µ–∫—É—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
    <div class="stat-item">
      <span>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</span>
      <span>{{ active_users|default('N/A') }}</span>
    </div>
    <div class="stat-item">
      <span>–ó–∞–ø—Ä–æ—Å–æ–≤ —Å–µ–≥–æ–¥–Ω—è:</span>
      <span>{{ requests_today|default('N/A') }}</span>
    </div>
    <div class="stat-item">
      <span>–ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–µ–≥–æ–¥–Ω—è:</span>
      <span>{{ blocks_today|default('N/A') }}</span>
    </div>
  </div>

  <div class="rate-limits">
    <!-- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è -->
    <div class="limit-card">
      <h3>üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
      <div class="limit-item">
        <span class="endpoint">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</span>
        <span class="limit">5/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span>
        <span class="limit">3/—á–∞—Å</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–í—ã—Ö–æ–¥</span>
        <span class="limit">10/–º–∏–Ω</span>
      </div>
    </div>

    <!-- API –∑–∞–º–µ—Ç–æ–∫ -->
    <div class="limit-card">
      <h3>üìù API –∑–∞–º–µ—Ç–æ–∫</h3>
      <div class="limit-item">
        <span class="endpoint">–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞</span>
        <span class="limit">30/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–°–æ–∑–¥–∞–Ω–∏–µ</span>
        <span class="limit">10/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
        <span class="limit">20/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–£–¥–∞–ª–µ–Ω–∏–µ</span>
        <span class="limit">5/–º–∏–Ω</span>
      </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="limit-card">
      <h3>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h3>
      <div class="limit-item">
        <span class="endpoint">–ü—Ä–æ—Å–º–æ—Ç—Ä</span>
        <span class="limit">20/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
        <span class="limit">5/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞</span>
        <span class="limit">3/–º–∏–Ω</span>
      </div>
    </div>

    <!-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <div class="limit-card">
      <h3>‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ</h3>
      <div class="limit-item">
        <span class="endpoint">–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤</span>
        <span class="limit">2/—á–∞—Å</span>
      </div>
    </div>

    <!-- –û–±—â–∏–µ -->
    <div class="limit-card">
      <h3>üåê –û–±—â–∏–µ</h3>
      <div class="limit-item">
        <span class="endpoint">–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</span>
        <span class="limit">100/–º–∏–Ω</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">Ping</span>
        <span class="limit">1000/—á–∞—Å</span>
      </div>
      <div class="limit-item">
        <span class="endpoint">–°–º–µ–Ω–∞ —è–∑—ã–∫–∞</span>
        <span class="limit">10/–º–∏–Ω</span>
      </div>
    </div>
  </div>

  <div class="info-box">
    <h4>üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏</h4>
    <ul>
      <li><strong>–•—Ä–∞–Ω–∏–ª–∏—â–µ:</strong> In-memory (Redis –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ)</li>
      <li><strong>–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> IP + User ID</li>
      <li><strong>–°–±—Ä–æ—Å –ª–∏–º–∏—Ç–æ–≤:</strong> –ü–æ –≤—Ä–µ–º–µ–Ω–∏ (–º–∏–Ω—É—Ç—ã/—á–∞—Å—ã)</li>
      <li><strong>–û—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏:</strong> HTTP 429 —Å Retry-After</li>
    </ul>
  </div>
</div>
{% endblock %}
